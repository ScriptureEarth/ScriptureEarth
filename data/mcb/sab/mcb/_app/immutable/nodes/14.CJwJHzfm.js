var Ne=Object.defineProperty;var Te=(n,e,t)=>e in n?Ne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var E=(n,e,t)=>Te(n,typeof e!="symbol"?e+"":e,t);import{s as se,e as v,a as W,c as S,b as q,g as O,f as g,m as _,o as C,i as P,h as y,z as fe,y as K,V as Ie,I as Pe,k as H,S as Qe,q as ae,t as z,d as j,j as J,P as Z,p as Me,n as X,r as de,D as Re,a7 as ne}from"../chunks/scheduler.B2eiZa_g.js";import{S as re,i as oe,c as x,a as $,m as ee,t as L,b as G,d as te,g as De,e as Ee,f as le}from"../chunks/index.BNSRDwh8.js";import{h as F,v as B,t as ce,s as Ce,y as ie,aj as We,l as Ae,ak as Oe,p as Fe}from"../chunks/theme.CEnq8wkH.js";import{N as Ue}from"../chunks/Navbar.CLDGmXiL.js";import{e as Y}from"../chunks/each.D6YF6ztN.js";import{S as Ve}from"../chunks/SearchIcon.BOkCasFG.js";import{s as Be,f as me}from"../chunks/numeralSystem.bc9fPTup.js";import{a as He}from"../chunks/index.QqT5-XEs.js";import{g as Le,b as ze}from"../chunks/entry.BaUVQd1j.js";function pe(n,e,t){const s=n.slice();return s[17]=e[t],s}function je(n){let e,t,s=Y(n[8]),r=[];for(let o=0;o<s.length;o+=1)r[o]=ge(pe(n,s,o));return{c(){e=v("div"),t=v("div");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=S(o,"DIV",{class:!0});var a=q(e);t=S(a,"DIV",{class:!0});var l=q(t);for(let c=0;c<r.length;c+=1)r[c].l(l);l.forEach(g),a.forEach(g),this.h()},h(){_(t,"class","special-characters"),_(e,"class","dy-form-control m-2")},m(o,a){P(o,e,a),y(e,t);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(t,null)},p(o,a){if(a&832){s=Y(o[8]);let l;for(l=0;l<s.length;l+=1){const c=pe(o,s,l);r[l]?r[l].p(c,a):(r[l]=ge(c),r[l].c(),r[l].m(t,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}},d(o){o&&g(e),ae(r,o)}}}function ge(n){let e,t=n[17]+"",s,r,o,a,l;function c(...i){return n[13](n[17],...i)}return{c(){e=v("button"),s=z(t),r=W(),this.h()},l(i){e=S(i,"BUTTON",{class:!0,style:!0});var f=q(e);s=j(f,t),r=O(f),f.forEach(g),this.h()},h(){_(e,"class","m-0.5 rounded w-8 h-10"),_(e,"style",o=B(n[6]["ui.search.buttons"]))},m(i,f){P(i,e,f),y(e,s),y(e,r),a||(l=K(e,"click",c),a=!0)},p(i,f){n=i,f&64&&o!==(o=B(n[6]["ui.search.buttons"]))&&_(e,"style",o)},d(i){i&&g(e),a=!1,l()}}}function Ge(n){let e,t,s,r,o=n[5].Search_Match_Whole_Words+"",a,l,c,i,f,I;return{c(){e=v("div"),t=v("label"),s=v("span"),r=v("bdi"),a=z(o),c=W(),i=v("input"),this.h()},l(d){e=S(d,"DIV",{class:!0});var u=q(e);t=S(u,"LABEL",{class:!0});var m=q(t);s=S(m,"SPAN",{class:!0,style:!0});var k=q(s);r=S(k,"BDI",{});var w=q(r);a=j(w,o),w.forEach(g),k.forEach(g),c=O(m),i=S(m,"INPUT",{type:!0,class:!0}),m.forEach(g),u.forEach(g),this.h()},h(){_(s,"class","dy-label-text"),_(s,"style",l=B(n[6]["ui.search.checkbox"])),_(i,"type","checkbox"),_(i,"class","dy-toggle"),_(t,"class","dy-label cursor-pointer"),_(e,"class","dy-form-control max-w-xs px-4 my-2")},m(d,u){P(d,e,u),y(e,t),y(t,s),y(s,r),y(r,a),y(t,c),y(t,i),i.checked=n[1],f||(I=K(i,"change",n[14]),f=!0)},p(d,u){u&32&&o!==(o=d[5].Search_Match_Whole_Words+"")&&J(a,o),u&64&&l!==(l=B(d[6]["ui.search.checkbox"]))&&_(s,"style",l),u&2&&(i.checked=d[1])},d(d){d&&g(e),f=!1,I()}}}function Je(n){let e,t,s,r,o=n[5].Search_Match_Accents+"",a,l,c,i,f,I;return{c(){e=v("div"),t=v("label"),s=v("span"),r=v("bdi"),a=z(o),c=W(),i=v("input"),this.h()},l(d){e=S(d,"DIV",{class:!0});var u=q(e);t=S(u,"LABEL",{class:!0});var m=q(t);s=S(m,"SPAN",{class:!0,style:!0});var k=q(s);r=S(k,"BDI",{});var w=q(r);a=j(w,o),w.forEach(g),k.forEach(g),c=O(m),i=S(m,"INPUT",{type:!0,class:!0}),m.forEach(g),u.forEach(g),this.h()},h(){_(s,"class","dy-label-text"),_(s,"style",l=B(n[6]["ui.search.checkbox"])),_(i,"type","checkbox"),_(i,"class","dy-toggle"),_(t,"class","dy-label cursor-pointer"),_(e,"class","dy-form-control max-w-xs px-4 my-2")},m(d,u){P(d,e,u),y(e,t),y(t,s),y(s,r),y(r,a),y(t,c),y(t,i),i.checked=n[2],f||(I=K(i,"change",n[15]),f=!0)},p(d,u){u&32&&o!==(o=d[5].Search_Match_Accents+"")&&J(a,o),u&64&&l!==(l=B(d[6]["ui.search.checkbox"]))&&_(s,"style",l),u&4&&(i.checked=d[2])},d(d){d&&g(e),f=!1,I()}}}function Ke(n){let e,t,s,r,o,a,l,c,i,f,I,d,u,m,k,w;i=new Ve({props:{color:n[7].SearchButtonTextColor}});let D=F.mainFeatures["search-input-buttons"]&&n[8].length>0&&je(n),A=F.mainFeatures["search-whole-words-show"]&&Ge(n),N=F.mainFeatures["search-accents-show"]&&Je(n);return{c(){e=v("form"),t=v("div"),s=v("label"),r=v("input"),l=W(),c=v("button"),x(i.$$.fragment),I=W(),D&&D.c(),d=W(),A&&A.c(),u=W(),N&&N.c(),this.h()},l(R){e=S(R,"FORM",{class:!0});var p=q(e);t=S(p,"DIV",{class:!0});var M=q(t);s=S(M,"LABEL",{class:!0});var T=q(s);r=S(T,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0,style:!0,size:!0,inputmode:!0,enterkeyhint:!0}),l=O(T),c=S(T,"BUTTON",{class:!0,style:!0});var h=q(c);$(i.$$.fragment,h),h.forEach(g),T.forEach(g),M.forEach(g),I=O(p),D&&D.l(p),d=O(p),A&&A.l(p),u=O(p),N&&N.l(p),p.forEach(g),this.h()},h(){_(r,"id","searchbar"),r.readOnly=n[4],_(r,"type","text"),_(r,"placeholder",o=n[5].Search_Text_Hint),_(r,"class","flex-grow px-4 py-2 mx-2 dy-input min-w-0 dy-input-bordered"),_(r,"style",a=B(n[6]["ui.search.entry-text"])),_(r,"size","1"),_(r,"inputmode","search"),_(r,"enterkeyhint","search"),C(r,"min-width","0"),C(r,"background-color",n[7].BackgroundColor),C(r,"border-color",n[7].DividerColor),_(c,"class","dy-btn mx-2 flex-none bg-gray-200"),_(c,"style",f=B(n[6]["ui.search.button"])),C(c,"border-color",n[7].DividerColor),_(s,"class","dy-input-group w-full flex"),_(t,"class","dy-form-control mb-4"),_(e,"class","w-full max-w-screen-md p-4")},m(R,p){P(R,e,p),y(e,t),y(t,s),y(s,r),n[11](r),fe(r,n[0]),y(s,l),y(s,c),ee(i,c,null),y(e,I),D&&D.m(e,null),y(e,d),A&&A.m(e,null),y(e,u),N&&N.m(e,null),m=!0,k||(w=[K(r,"input",n[12]),K(c,"click",Ie(n[10]))],k=!0)},p(R,[p]){(!m||p&16)&&(r.readOnly=R[4]),(!m||p&32&&o!==(o=R[5].Search_Text_Hint))&&_(r,"placeholder",o),(!m||p&64&&a!==(a=B(R[6]["ui.search.entry-text"])))&&_(r,"style",a),p&1&&r.value!==R[0]&&fe(r,R[0]);const M=p&64;(p&64||M)&&C(r,"min-width","0"),(p&192||M)&&C(r,"background-color",R[7].BackgroundColor),(p&192||M)&&C(r,"border-color",R[7].DividerColor);const T={};p&128&&(T.color=R[7].SearchButtonTextColor),i.$set(T),(!m||p&64&&f!==(f=B(R[6]["ui.search.button"])))&&_(c,"style",f);const h=p&64;(p&192||h)&&C(c,"border-color",R[7].DividerColor),F.mainFeatures["search-input-buttons"]&&R[8].length>0&&D.p(R,p),F.mainFeatures["search-whole-words-show"]&&A.p(R,p),F.mainFeatures["search-accents-show"]&&N.p(R,p)},i(R){m||(L(i.$$.fragment,R),m=!0)},o(R){G(i.$$.fragment,R),m=!1},d(R){R&&g(e),n[11](null),te(i),D&&D.d(),A&&A.d(),N&&N.d(),k=!1,Pe(w)}}}function Xe(n,e,t){var R;let s,r,o;H(n,ce,p=>t(5,s=p)),H(n,Ce,p=>t(6,r=p)),H(n,ie,p=>t(7,o=p));let{phrase:a}=e,{wholeWords:l}=e,{matchAccents:c}=e,i;const f=((R=F.mainFeatures["input-buttons"])==null?void 0:R.split(" ").filter(p=>p.length))??[];function I(p,M){M.preventDefault();const T=i.selectionStart,h=i.selectionEnd;t(0,a=a.slice(0,T)+p+a.slice(h)),i.focus(),requestAnimationFrame(()=>i.setSelectionRange(T+p.length,T+p.length))}let d=!1;const u=Qe();function m(){a&&(t(4,d=!0),setTimeout(()=>{t(4,d=!1)},50),u("submit",{phrase:a,wholeWords:l,matchAccents:c}))}function k(p){Z[p?"unshift":"push"](()=>{i=p,t(3,i)})}function w(){a=this.value,t(0,a)}const D=(p,M)=>I(p,M);function A(){l=this.checked,t(1,l)}function N(){c=this.checked,t(2,c)}return n.$$set=p=>{"phrase"in p&&t(0,a=p.phrase),"wholeWords"in p&&t(1,l=p.wholeWords),"matchAccents"in p&&t(2,c=p.matchAccents)},[a,l,c,i,d,s,r,o,f,I,m,k,w,D,A,N]}class Ye extends re{constructor(e){super(),oe(this,e,Xe,Ke,se,{phrase:0,wholeWords:1,matchAccents:2})}}function Ze(n){return n.type==="docset-url-request"}class xe{constructor(e,t){E(this,"getDocSetUrl");E(this,"baseURI");this.getDocSetUrl=e,this.baseURI=t}requestHandler(){return e=>this.onRequest(e)}async onRequest(e){return Ze(e)?this.onDocsetUrlRequest(e):this.onUnknownRequest(e)}onDocsetUrlRequest(e){return{type:"docset-url",url:this.getDocSetUrl(e.docSet),base:this.baseURI}}onUnknownRequest(e){return{type:"error",message:`Unrecognized worker request: ${e.type}`}}}function $e(n){return n.type==="new-query-response"}function et(n){return n.type==="results-response"}class tt{constructor({id:e,outboundHandler:t}){E(this,"isComplete");E(this,"queryId");E(this,"outboundHandler");this.queryId=e,this.outboundHandler=t}async getResults(e){const t={type:"results-request",limit:e,queryId:this.queryId},s=await this.outboundHandler(t);return this.parseResponse(s)}parseResponse(e){if(et(e))return this.isComplete=e.queryDone,e.results;throw new Error(`Search query returned invalid message of type ${e.type}: ${e}`)}}function st(n){return n.type==="error"}class rt{constructor(e,{timeout:t=5e3,inboundHandler:s}={}){E(this,"io");E(this,"requestHandler");E(this,"timeout");E(this,"pendingRequests",new Map);E(this,"lastRequest",-1);this.requestHandler=s,this.io=e,this.timeout=t,e.setOnMessage(r=>this.onMessage(r))}setInboundHandler(e){this.requestHandler=e}outboundHandler(){return e=>this.postRequest(e)}postRequest(e){const t=++this.lastRequest,s={transactionId:t,type:"request",payload:e},r=new Promise((o,a)=>{this.pendingRequests.set(t,{resolve:o,reject:a}),this.io.postMessage(s)});return this.addTimeout(r,e,t)}addTimeout(e,t,s){if(!this.timeout)return e;const r=this.setRequestTimeout(t,s);return Promise.race([e,r])}async setRequestTimeout(e,t){return await new Promise(s=>setTimeout(s,this.timeout)),this.pendingRequests.delete(t),await Promise.reject(new Error(`Message request timed out after ${this.timeout} ms. Request type: ${e.type}`))}onMessage(e){const t=e.data;if((t==null?void 0:t.type)==="request")this.onRequest(t);else if((t==null?void 0:t.type)==="response")this.onResponse(t);else throw new Error(`Invalid message from worker: ${t}`)}async onRequest(e){if(!this.requestHandler)throw new Error("Messenger incoming request handler was undefined. Did you foget to call setInboundHandler?");const t=await this.requestHandler(e.payload),s={transactionId:e.transactionId,type:"response",payload:t};this.io.postMessage(s)}onResponse(e){const t=e.transactionId;if(!this.pendingRequests.has(t))throw new Error(`No callback to handle response for message transaction ${t}`);const s=e.payload,{resolve:r,reject:o}=this.pendingRequests.get(t);st(s)?o(new Error(s.message)):r(s),this.pendingRequests.delete(t)}}class ot{constructor(e,t,s){E(this,"messenger");E(this,"queryGenerator");E(this,"createQuery",async(e,t)=>{const s=await this.requestNewQuery(e,t),r=this.messenger.outboundHandler();return this.queryGenerator({id:s,outboundHandler:r})});this.messenger=new rt(e,{inboundHandler:s,timeout:null}),this.queryGenerator=t}async requestNewQuery(e,t){const s={type:"new-query-request",phrase:e,options:t},r=await this.messenger.postRequest(s);if($e(r))return r.queryId;throw new Error(`Upexpected response type for request ${s.type}: ${r.type}`)}}const _e=new Worker(new URL(""+new URL("../workers/worker-script-zP8ERVwx.js",import.meta.url).href,import.meta.url),{type:"module"}),nt={postMessage:function(n){_e.postMessage(n)},setOnMessage:function(n){_e.onmessage=n}};function lt(){const n=new xe(We,document.baseURI),e=new ot(nt,t=>new tt(t),n.requestHandler());return(t,s)=>e.createQuery(t,s)}class at{searchWholeWordsDefault(){return F.mainFeatures["search-whole-words-default"]}searchAccentsDefault(){return F.mainFeatures["search-accents-default"]}searchAccentsToRemove(){return F.mainFeatures["search-accents-to-remove"]}bookCollection(e){return F.bookCollections.find(t=>t.id===e)}}function be(n,e,t){n[e]?n[e]+=t:n[e]=t}class ct{constructor(e){E(this,"config");this.config=e}searchIgnore(){const e=this.config.searchAccentsToRemove();let t="";for(const s of e.matchAll(/\\u(03\d\d)/g)){const r=parseInt(s[1],16),o=String.fromCodePoint(r);t+=o}return t}searchSubtitute(){const e=this.config.searchAccentsToRemove(),t={};for(const s of e.matchAll(/(\S)>(\S)/g))be(t,s[1],s[2]),be(t,s[2],s[1]);return t}collectionToDocSet(e){const t=this.config.bookCollection(e);return t.languageCode+"_"+t.id}userLanguage(){return Me(Ae)}}class it{async save(e){localStorage.setItem("search-results",JSON.stringify(e))}async read(){const e=localStorage.getItem("search-results");return e?JSON.parse(e):null}}class ut{constructor(e){E(this,"repo");this.repo=e}configureOptions(e){const t=this.repo.collectionToDocSet(e.collection),s=this.repo.userLanguage(),r=e.matchAccents?void 0:this.repo.searchIgnore(),o=e.matchAccents?void 0:this.repo.searchSubtitute();return{docSet:t,collection:e.collection,wholeWords:e.wholeWords,ignore:r,substitute:o,locale:s}}}class ht{constructor({queryGenerator:e}){E(this,"createQuery");E(this,"onResults");E(this,"onNewQuery");E(this,"queryID",0);this.createQuery=e}setOnResults(e){this.onResults=e}setOnNewQuery(e){this.onNewQuery=e}async submit(e,t,{batchSize:s=10,limit:r=1/0}={}){this.queryID++;const o=this.queryID;this.onNewQuery&&this.onNewQuery();const a=await this.createQuery(e,t);await this.runQuery(a,o,{batchSize:s,limit:r})}async runQuery(e,t,{batchSize:s,limit:r}){let o=0;for(;!e.isComplete&&o<r;){let a=await e.getResults(s);if(o+a.length>r&&(a=a.slice(0,r-o)),t!=this.queryID)break;this.onResults&&this.onResults(a),o+=a.length}}}class ft{constructor({presenter:e,config:t,configureOptions:s,queryManager:r,storage:o}){E(this,"presenter");E(this,"config");E(this,"configureOptions");E(this,"queryManager");E(this,"storage");E(this,"results");this.presenter=e,this.config=t,this.configureOptions=s,this.queryManager=r,this.storage=o,r.setOnResults(a=>this.onResults(a)),r.setOnNewQuery(()=>e.onNewQuery()),e.setOptions("",{wholeWords:t.searchWholeWordsDefault(),matchAccents:t.searchAccentsDefault(),collection:""})}onResults(e){this.results.push(...e),this.presenter.onResults(e)}async submit(e,t){this.results=[],await this.queryManager.submit(e,this.configureOptions(t),{batchSize:1,limit:1e3});const s=this.results;this.storage.save({phrase:e,options:t,results:s}),this.presenter.onQueryDone()}async loadLastQuery(){const e=await this.storage.read();e&&(this.presenter.setOptions(e.phrase,e.options),this.presenter.onResults((e==null?void 0:e.results)??[]))}}function dt(n){const e=new at,t=new ct(e),s=new ut(t),r=lt();return new ft({presenter:n,config:e,configureOptions:o=>s.configureOptions(o),queryManager:new ht({queryGenerator:r}),storage:new it})}function ye(n,e,t){const s=n.slice();return s[8]=e[t],s}function we(n){let e,t=n[8].content+"",s;return{c(){e=v("span"),s=z(t),this.h()},l(r){e=S(r,"SPAN",{});var o=q(e);s=j(o,t),o.forEach(g),this.h()},h(){C(e,"font-weight",n[8].matchesQuery?"bold":"normal"),C(e,"text-decoration",n[8].matchesQuery?"underline":"none")},m(r,o){P(r,e,o),y(e,s)},p(r,o){o&1&&t!==(t=r[8].content+"")&&J(s,t),o&1&&C(e,"font-weight",r[8].matchesQuery?"bold":"normal"),o&1&&C(e,"text-decoration",r[8].matchesQuery?"underline":"none")},d(r){r&&g(e)}}}function mt(n){let e,t,s,r,o=n[1](n[0])+"",a,l,c,i,f,I,d=Y(n[0].chunks),u=[];for(let m=0;m<d.length;m+=1)u[m]=we(ye(n,d,m));return{c(){e=v("div"),t=v("button"),s=v("div"),r=v("h1"),a=z(o),l=W(),c=v("div"),i=v("p");for(let m=0;m<u.length;m+=1)u[m].c();this.h()},l(m){e=S(m,"DIV",{class:!0});var k=q(e);t=S(k,"BUTTON",{class:!0});var w=q(t);s=S(w,"DIV",{class:!0});var D=q(s);r=S(D,"H1",{});var A=q(r);a=j(A,o),A.forEach(g),D.forEach(g),l=O(w),c=S(w,"DIV",{class:!0});var N=q(c);i=S(N,"P",{class:!0});var R=q(i);for(let p=0;p<u.length;p+=1)u[p].l(R);R.forEach(g),N.forEach(g),w.forEach(g),k.forEach(g),this.h()},h(){_(s,"class","search-result-reference flex"),_(i,"class","text-start"),_(c,"class","search-result-context flex"),_(t,"class","text-start"),_(e,"class","search-result-block w-full transition-shadow duration-300 hover:shadow-lg cursor-pointer")},m(m,k){P(m,e,k),y(e,t),y(t,s),y(s,r),y(r,a),y(t,l),y(t,c),y(c,i);for(let w=0;w<u.length;w+=1)u[w]&&u[w].m(i,null);f||(I=K(t,"click",Ie(n[2])),f=!0)},p(m,[k]){if(k&1&&o!==(o=m[1](m[0])+"")&&J(a,o),k&1){d=Y(m[0].chunks);let w;for(w=0;w<d.length;w+=1){const D=ye(m,d,w);u[w]?u[w].p(D,k):(u[w]=we(D),u[w].c(),u[w].m(i,null))}for(;w<u.length;w+=1)u[w].d(1);u.length=d.length}},i:X,o:X,d(m){m&&g(e),ae(u,m),f=!1,I()}}}function pt(n,e,t){let{docSet:s}=e,{collection:r}=e,{result:o}=e;F.bookCollections.find(f=>f.id===r).style.textDirection.toLowerCase();function a(f){const I=l(f.reference),d=F.bookCollections.find(m=>m.id===r).features["ref-chapter-verse-separator"];let u=I.book;return I.chapter&&(u+=" "+I.chapter,I.verses&&(u+=d+I.verses)),u}function l(f){const I=Be(F,f.collection,f.bookCode);return{book:c(f.bookCode),chapter:me(I,f.chapter),verses:me(I,f.verses)}}function c(f){return F.bookCollections.filter(u=>u.id===r)[0].books.filter(u=>u.id===f)[0].name}function i(){He({docSet:s,collection:r,book:o.reference.bookCode,chapter:o.reference.chapter,verse:o.reference.verses})}return n.$$set=f=>{"docSet"in f&&t(3,s=f.docSet),"collection"in f&&t(4,r=f.collection),"result"in f&&t(0,o=f.result)},[o,a,i,s,r]}class gt extends re{constructor(e){super(),oe(this,e,pt,mt,se,{docSet:3,collection:4,result:0})}}function ve(n,e,t){const s=n.slice();return s[21]=e[t],s}function _t(n){let e,t,s,r=Y(n[3]),o=[];for(let l=0;l<r.length;l+=1)o[l]=Se(ve(n,r,l));const a=l=>G(o[l],1,1,()=>{o[l]=null});return{c(){for(let l=0;l<o.length;l+=1)o[l].c();e=W(),t=v("div"),this.h()},l(l){for(let c=0;c<o.length;c+=1)o[c].l(l);e=O(l),t=S(l,"DIV",{class:!0}),q(t).forEach(g),this.h()},h(){_(t,"class","py-4")},m(l,c){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,c);P(l,e,c),P(l,t,c),s=!0},p(l,c){if(c&9){r=Y(l[3]);let i;for(i=0;i<r.length;i+=1){const f=ve(l,r,i);o[i]?(o[i].p(f,c),L(o[i],1)):(o[i]=Se(f),o[i].c(),L(o[i],1),o[i].m(e.parentNode,e))}for(De(),i=r.length;i<o.length;i+=1)a(i);Ee()}},i(l){if(!s){for(let c=0;c<r.length;c+=1)L(o[c]);s=!0}},o(l){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)G(o[c]);s=!1},d(l){l&&(g(e),g(t)),ae(o,l)}}}function bt(n){let e,t,s=n[6].Search_Searching+"",r,o,a,l;return{c(){e=v("p"),t=v("bdi"),r=z(s),a=W(),l=v("span"),this.h()},l(c){e=S(c,"P",{style:!0});var i=q(e);t=S(i,"BDI",{});var f=q(t);r=j(f,s),f.forEach(g),i.forEach(g),a=O(c),l=S(c,"SPAN",{class:!0}),q(l).forEach(g),this.h()},h(){_(e,"style",o=B(n[9]["ui.search.progress-label"])),C(e,"text-align","center"),_(l,"class","spin svelte-1r2kkus")},m(c,i){P(c,e,i),y(e,t),y(t,r),P(c,a,i),P(c,l,i)},p(c,i){i&64&&s!==(s=c[6].Search_Searching+"")&&J(r,s),i&512&&o!==(o=B(c[9]["ui.search.progress-label"]))&&_(e,"style",o);const f=i&512;(i&512||f)&&C(e,"text-align","center")},i:X,o:X,d(c){c&&(g(e),g(a),g(l))}}}function yt(n){let e,t,s=n[6].Search_No_Matches_Found+"",r,o=`${n[8]}px`;return{c(){e=v("div"),t=v("p"),r=z(s),this.h()},l(a){e=S(a,"DIV",{class:!0});var l=q(e);t=S(l,"P",{});var c=q(t);r=j(c,s),c.forEach(g),l.forEach(g),this.h()},h(){C(t,"font-family",n[7]),C(t,"font-size",o),_(e,"class","py-4 flex justify-center")},m(a,l){P(a,e,l),y(e,t),y(t,r)},p(a,l){l&64&&s!==(s=a[6].Search_No_Matches_Found+"")&&J(r,s),l&128&&C(t,"font-family",a[7]),l&256&&o!==(o=`${a[8]}px`)&&C(t,"font-size",o)},i:X,o:X,d(a){a&&g(e)}}}function Se(n){let e,t;return e=new gt({props:{result:n[21],collection:n[0],docSet:n[21].reference.docSet}}),{c(){x(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){const o={};r&8&&(o.result=s[21]),r&1&&(o.collection=s[0]),r&8&&(o.docSet=s[21].reference.docSet),e.$set(o)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){G(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function ke(n){let e,t,s,r,o,a=!n[2]&&qe(n);return{c(){e=v("div"),t=v("span"),a&&a.c(),s=W(),r=v("span"),o=z(n[5]),this.h()},l(l){e=S(l,"DIV",{class:!0,style:!0});var c=q(e);t=S(c,"SPAN",{class:!0});var i=q(t);a&&a.l(i),i.forEach(g),s=O(c),r=S(c,"SPAN",{class:!0});var f=q(r);o=j(f,n[5]),f.forEach(g),c.forEach(g),this.h()},h(){_(t,"class","mx-4"),_(r,"class","mx-4"),_(e,"class","fixed bottom-0 w-full max-w-screen-md flex justify-between shadow-lg"),C(e,"box-shadow","0 -4px 6px -1px rgba(0, 0, 0, 0.1), 0 -2px 4px -2px rgba(0, 0, 0, 0.1)"),C(e,"background-color",n[10].BackgroundColor)},m(l,c){P(l,e,c),y(e,t),a&&a.m(t,null),y(e,s),y(e,r),y(r,o)},p(l,c){l[2]?a&&(a.d(1),a=null):a?a.p(l,c):(a=qe(l),a.c(),a.m(t,null)),c&32&&J(o,l[5]),c&1024&&C(e,"background-color",l[10].BackgroundColor)},d(l){l&&g(e),a&&a.d()}}}function qe(n){let e,t=n[6].Search_Searching+"",s;return{c(){e=v("bdi"),s=z(t)},l(r){e=S(r,"BDI",{});var o=q(e);s=j(o,t),o.forEach(g)},m(r,o){P(r,e,o),y(e,s)},p(r,o){o&64&&t!==(t=r[6].Search_Searching+"")&&J(s,t)},d(r){r&&g(e)}}}function wt(n){let e,t,s,r,o,a,l,c;const i=[yt,bt,_t],f=[];function I(u,m){return u[2]&&u[1].length===0?0:u[4]?1:2}t=I(n),s=f[t]=i[t](n);let d=n[1].length&&ke(n);return{c(){e=v("div"),s.c(),r=W(),o=v("div"),a=W(),d&&d.c(),l=de(),this.h()},l(u){e=S(u,"DIV",{id:!0,class:!0});var m=q(e);s.l(m),r=O(m),o=S(m,"DIV",{id:!0,style:!0}),q(o).forEach(g),m.forEach(g),a=O(u),d&&d.l(u),l=de(),this.h()},h(){_(o,"id","sentinel"),C(o,"height","1px"),_(e,"id","container"),_(e,"class","search-result p-2 max-w-screen-md w-full")},m(u,m){P(u,e,m),f[t].m(e,null),y(e,r),y(e,o),P(u,a,m),d&&d.m(u,m),P(u,l,m),c=!0},p(u,[m]){let k=t;t=I(u),t===k?f[t].p(u,m):(De(),G(f[k],1,1,()=>{f[k]=null}),Ee(),s=f[t],s?s.p(u,m):(s=f[t]=i[t](u),s.c()),L(s,1),s.m(e,r)),u[1].length?d?d.p(u,m):(d=ke(u),d.c(),d.m(l.parentNode,l)):d&&(d.d(1),d=null)},i(u){c||(L(s),c=!0)},o(u){G(s),c=!1},d(u){u&&(g(e),g(a),g(l)),f[t].d(),d&&d.d(u)}}}function vt(n,e,t){let s,r,o,a,l,c,i,f;H(n,Ae,h=>t(14,o=h)),H(n,ce,h=>t(6,a=h)),H(n,Oe,h=>t(7,l=h)),H(n,Fe,h=>t(8,c=h)),H(n,Ce,h=>t(9,i=h)),H(n,ie,h=>t(10,f=h));let{collection:I}=e,{results:d}=e,{queryDone:u}=e,{restore:m}=e,{queryId:k}=e,w=k,D=[];function A(){if(m){t(11,m=!1);const h=localStorage.getItem("search-result-display-length");p(parseInt(h,10))}T()}function N(h){h!==w&&(w=h,t(3,D=[]))}function R(h){const b=a.Search_Number_Found,Q=/%,?d/,U=b.match(Q);if(!U)return b;let V;return U[0].includes(",")?V=Intl.NumberFormat(o).format(h):V=h.toString(),b.replace(Q,V)}function p(h=20){t(3,D=d.slice(0,D.length+h)),localStorage.setItem("search-result-display-length",D.length.toString())}function M(h){h[0].isIntersecting&&!s&&(p(),T())}function T(){if(d.length===0||d.length===D.length)return;const h=document.querySelector("#sentinel"),b=new IntersectionObserver(Q=>{Q[0].isIntersecting?(p(),T()):b.disconnect()},{root:null,rootMargin:"0px",threshold:.1});b.observe(h)}return Re(()=>{const h=new IntersectionObserver(M,{root:null,rootMargin:"0px",threshold:1}),b=document.querySelector("#sentinel");return b&&h.observe(b),()=>{b&&h.unobserve(b)}}),n.$$set=h=>{"collection"in h&&t(0,I=h.collection),"results"in h&&t(1,d=h.results),"queryDone"in h&&t(2,u=h.queryDone),"restore"in h&&t(11,m=h.restore),"queryId"in h&&t(12,k=h.queryId)},n.$$.update=()=>{n.$$.dirty&6&&t(4,s=!u&&d.length===0),n.$$.dirty&4096&&N(k),n.$$.dirty&2&&A(),n.$$.dirty&2&&t(5,r=R(d.length))},[I,d,u,D,s,r,a,l,c,i,f,m,k]}class St extends re{constructor(e){super(),oe(this,e,vt,wt,se,{collection:0,results:1,queryDone:2,restore:11,queryId:12})}}function kt(n){let e,t,s=n[9].Search+"",r;return{c(){e=v("label"),t=v("div"),r=z(s),this.h()},l(o){e=S(o,"LABEL",{for:!0,slot:!0});var a=q(e);t=S(a,"DIV",{class:!0});var l=q(t);r=j(l,s),l.forEach(g),a.forEach(g),this.h()},h(){_(t,"class","btn btn-ghost normal-case text-xl"),_(e,"for","sidebar"),_(e,"slot","center")},m(o,a){P(o,e,a),y(e,t),y(t,r)},p(o,a){a&512&&s!==(s=o[9].Search+"")&&J(r,s)},d(o){o&&g(e)}}}function qt(n){let e,t,s,r,o,a,l,c,i,f,I,d,u,m,k,w,D,A,N;s=new Ue({props:{$$slots:{center:[kt]},$$scope:{ctx:n}}});function R(h){n[13](h)}function p(h){n[14](h)}function M(h){n[15](h)}let T={};return n[1]!==void 0&&(T.phrase=n[1]),n[2]!==void 0&&(T.wholeWords=n[2]),n[3]!==void 0&&(T.matchAccents=n[3]),l=new Ye({props:T}),Z.push(()=>le(l,"phrase",R)),Z.push(()=>le(l,"wholeWords",p)),Z.push(()=>le(l,"matchAccents",M)),l.$on("submit",n[11]),w=new St({props:{collection:n[0].collection,results:n[4],queryId:n[5],queryDone:n[6],restore:n[7]}}),{c(){e=v("div"),t=v("div"),x(s.$$.fragment),r=W(),o=v("div"),a=v("div"),x(l.$$.fragment),I=W(),d=v("div"),u=v("hr"),m=W(),k=v("div"),x(w.$$.fragment),this.h()},l(h){e=S(h,"DIV",{class:!0,style:!0});var b=q(e);t=S(b,"DIV",{class:!0});var Q=q(t);$(s.$$.fragment,Q),Q.forEach(g),r=O(b),o=S(b,"DIV",{class:!0});var U=q(o);a=S(U,"DIV",{class:!0});var V=q(a);$(l.$$.fragment,V),V.forEach(g),I=O(U),d=S(U,"DIV",{class:!0});var ue=q(d);u=S(ue,"HR",{class:!0}),ue.forEach(g),m=O(U),k=S(U,"DIV",{class:!0});var he=q(k);$(w.$$.fragment,he),he.forEach(g),U.forEach(g),b.forEach(g),this.h()},h(){_(t,"class","navbar"),_(a,"class","flex justify-center"),_(u,"class","max-w-screen-md w-full"),C(u,"border-color",n[10].DividerColor),_(d,"class","flex justify-center px-4"),_(k,"class","flex justify-center"),_(o,"class","overflow-auto"),_(e,"class","grid grid-rows-[auto,1fr,auto]"),C(e,"height","100vh"),C(e,"height","100dvh")},m(h,b){P(h,e,b),y(e,t),ee(s,t,null),y(e,r),y(e,o),y(o,a),ee(l,a,null),y(o,I),y(o,d),y(d,u),y(o,m),y(o,k),ee(w,k,null),n[16](o),D=!0,A||(N=K(o,"scroll",n[12]),A=!0)},p(h,[b]){const Q={};b&4194816&&(Q.$$scope={dirty:b,ctx:h}),s.$set(Q);const U={};!c&&b&2&&(c=!0,U.phrase=h[1],ne(()=>c=!1)),!i&&b&4&&(i=!0,U.wholeWords=h[2],ne(()=>i=!1)),!f&&b&8&&(f=!0,U.matchAccents=h[3],ne(()=>f=!1)),l.$set(U),b&1024&&C(u,"border-color",h[10].DividerColor);const V={};b&1&&(V.collection=h[0].collection),b&16&&(V.results=h[4]),b&32&&(V.queryId=h[5]),b&64&&(V.queryDone=h[6]),b&128&&(V.restore=h[7]),w.$set(V)},i(h){D||(L(s.$$.fragment,h),L(l.$$.fragment,h),L(w.$$.fragment,h),D=!0)},o(h){G(s.$$.fragment,h),G(l.$$.fragment,h),G(w.$$.fragment,h),D=!1},d(h){h&&g(e),te(s),te(l),te(w),n[16](null),A=!1,N()}}}function It(n,e,t){let s,r;H(n,ce,b=>t(9,s=b)),H(n,ie,b=>t(10,r=b));let{data:o}=e,a,l,c,i=[],f=0,I=!0,d=!1,u,m=0,k=!1;const D=dt({setOptions(b,Q){t(1,a=b),t(2,l=Q.wholeWords),t(3,c=Q.matchAccents)},onResults(b){t(4,i=i.concat(b))},onNewQuery(){t(4,i=[]),t(6,I=!1)},onQueryDone(){t(6,I=!0)}});function A(b){Le(`${ze}/search/${o.collection}?savedResults=true`),t(5,f++,f);const Q={collection:o.collection,wholeWords:b.detail.wholeWords,matchAccents:b.detail.matchAccents};D.submit(b.detail.phrase,Q)}function N(){k=!1,m=u.scrollTop;const b=m;setTimeout(()=>{m===b&&!k&&(localStorage.setItem("search-scroll-pos",m.toString()),k=!0)},100)}async function R(){if(new URLSearchParams(window.location.search).get("savedResults")){t(7,d=!0),await D.loadLastQuery(),t(7,d=!1);const Q=localStorage.getItem("search-scroll-pos");t(8,u.scrollTop=Q?parseInt(Q,10):0,u),N()}}Re(()=>(R(),()=>{k||(k=!0,localStorage.setItem("search-scroll-pos",m.toString()))}));function p(b){a=b,t(1,a)}function M(b){l=b,t(2,l)}function T(b){c=b,t(3,c)}function h(b){Z[b?"unshift":"push"](()=>{u=b,t(8,u)})}return n.$$set=b=>{"data"in b&&t(0,o=b.data)},[o,a,l,c,i,f,I,d,u,s,r,A,N,p,M,T,h]}class Wt extends re{constructor(e){super(),oe(this,e,It,qt,se,{data:0})}}export{Wt as component};
