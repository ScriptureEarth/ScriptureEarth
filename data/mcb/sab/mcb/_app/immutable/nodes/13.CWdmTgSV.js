import{b as X,a as tt}from"../chunks/entry.BaUVQd1j.js";import{o as lt,h as re,w as st,ad as qe,r as ot,p as nt,t as it,ae as rt,A as ct,B as ut}from"../chunks/theme.CEnq8wkH.js";import{a5 as at,a6 as ft,$ as ie,U as dt,s as _t,e as q,a as C,c as w,b as I,f as p,g as j,m as k,o as Y,i as Q,h as v,k as oe,T as ht,y as ne,I as mt,E as pt,t as T,d as P,j as F,r as Z,n as H,l as Oe,q as Le,C as ce,v as L}from"../chunks/scheduler.B2eiZa_g.js";import{g as ae,b as O,e as fe,t as B,S as bt,i as gt,c as $,a as x,m as ee,d as te}from"../chunks/index.BNSRDwh8.js";import{e as ue}from"../chunks/each.D6YF6ztN.js";import{N as vt,A as kt}from"../chunks/Navbar.CLDGmXiL.js";import{T as zt}from"../chunks/TextAppearanceIcon.BU1t6h4r.js";import{A as He}from"../chunks/index.4IN-9o6T.js";import{B as qt}from"../chunks/BookSelector.CzYvgeJV.js";function we(l,e){const t=e.token={};function s(o,n,i,c){if(e.token!==t)return;e.resolved=c;let _=e.ctx;i!==void 0&&(_=_.slice(),_[i]=c);const h=o&&(e.current=o)(_);let u=!1;e.block&&(e.blocks?e.blocks.forEach((a,r)=>{r!==n&&a&&(ae(),O(a,1,1,()=>{e.blocks[r]===a&&(e.blocks[r]=null)}),fe())}):e.block.d(1),h.c(),B(h,1),h.m(e.mount(),e.anchor),u=!0),e.block=h,e.blocks&&(e.blocks[n]=h),u&&dt()}if(at(l)){const o=ft();if(l.then(n=>{ie(o),s(e.then,1,e.value,n),ie(null)},n=>{if(ie(o),s(e.catch,2,e.error,n),ie(null),!e.hasCatch)throw n}),e.current!==e.pending)return s(e.pending,0),!0}else{if(e.current!==e.then)return s(e.then,1,e.value,l),!0;e.resolved=l}}function wt(l,e,t){const s=e.slice(),{resolved:o}=l;l.current===l.then&&(s[l.value]=o),l.current===l.catch&&(s[l.error]=o),l.block.p(s,t)}let he=null;async function Ge(){return he||(he=await lt("quiz",1,{upgrade(l){const e=l.createObjectStore("quiz",{keyPath:"date"});e.createIndex("collection, book",["collection","book"]),e.createIndex("date","date")}})),he}async function Ie(l){try{const e=await Ge();if(!e){console.error("Failed to open quiz database");return}const t=new Date()[Symbol.toPrimitive]("number"),o=re.bookCollections.find(i=>i.id===l.collection).books.findIndex(i=>i.id===l.book),n={...l,date:t,bookIndex:o};await e.add("quiz",n)}catch(e){console.error("Error adding quiz result:",e)}}async function It(l){return(await(await Ge()).getAllFromIndex("quiz","collection, book")).some(s=>s.book===l&&s.pass)}async function Et({params:l,fetch:e}){const t=l.id,s=l.collection,o=re.bookCollections.find(a=>a.id===s),n=o.books.find(a=>a.id===t);let i=!1,c=null,_=null;if(n.quizFeatures["access-type"]==="after"&&(c=n.quizFeatures["access-after"],i=!await It(c)),i&&c){const a=o.books.find(r=>r.id===c);_=a?a.name:c}let h,u=0;if(!i)try{const a=await e(`${X}/collections/${s}/quizzes/${t}.json`);if(!a.ok)throw new Error("Failed to fetch quiz JSON file");h=await a.json(),u=h.passScore}catch(a){console.error("Error fetching quiz JSON file:",a)}return{quiz:h,locked:i,quizId:t,quizName:n.name,dependentQuizId:c,dependentQuizName:_,passScore:u}}const Yt=Object.freeze(Object.defineProperty({__proto__:null,load:Et},Symbol.toStringTag,{value:"Module"}));function Ee(l,e,t){const s=l.slice();return s[51]=e[t],s[53]=t,s}function Ae(l,e,t){const s=l.slice();return s[51]=e[t],s[53]=t,s}function me(l){const e=l.slice(),t=e[7]>=e[14];return e[48]=t,e}function At(l){let e,t,s;return t=new qt({props:{displayLabel:l[13]}}),{c(){e=q("div"),$(t.$$.fragment),this.h()},l(o){e=w(o,"DIV",{slot:!0});var n=I(e);x(t.$$.fragment,n),n.forEach(p),this.h()},h(){k(e,"slot","left-buttons")},m(o,n){Q(o,e,n),ee(t,e,null),s=!0},p(o,n){const i={};n[0]&8192&&(i.displayLabel=o[13]),t.$set(i)},i(o){s||(B(t.$$.fragment,o),s=!0)},o(o){O(t.$$.fragment,o),s=!1},d(o){o&&p(e),te(t)}}}function Dt(l){let e,t;return e=new He.Mute({props:{color:"white"}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,o){ee(e,s,o),t=!0},i(s){t||(B(e.$$.fragment,s),t=!0)},o(s){O(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function St(l){let e,t;return e=new He.Volume({props:{color:"white"}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,o){ee(e,s,o),t=!0},i(s){t||(B(e.$$.fragment,s),t=!0)},o(s){O(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function Vt(l){let e,t,s,o,n,i,c,_,h,u,a;const r=[St,Dt],f=[];function m(d,g){return d[16]?0:1}return o=m(l),n=f[o]=r[o](l),_=new zt({props:{color:"white"}}),{c(){e=q("div"),t=q("div"),s=q("button"),n.c(),i=C(),c=q("label"),$(_.$$.fragment),this.h()},l(d){e=w(d,"DIV",{slot:!0,class:!0});var g=I(e);t=w(g,"DIV",{class:!0});var E=I(t);s=w(E,"BUTTON",{class:!0});var z=I(s);n.l(z),z.forEach(p),E.forEach(p),i=j(g),c=w(g,"LABEL",{class:!0});var V=I(c);x(_.$$.fragment,V),V.forEach(p),g.forEach(p),this.h()},h(){k(s,"class","dy-btn dy-btn-ghost dy-btn-circle"),k(t,"class","flex"),k(c,"class","dy-btn dy-btn-ghost p-0.5 dy-no-animation"),k(e,"slot","right-buttons"),k(e,"class","flex items-center")},m(d,g){Q(d,e,g),v(e,t),v(t,s),f[o].m(s,null),v(e,i),v(e,c),ee(_,c,null),h=!0,u||(a=[ne(s,"click",l[27]),ne(c,"click",l[28])],u=!0)},p(d,g){let E=o;o=m(d),o!==E&&(ae(),O(f[E],1,1,()=>{f[E]=null}),fe(),n=f[o],n||(n=f[o]=r[o](d),n.c()),B(n,1),n.m(s,null))},i(d){h||(B(n),B(_.$$.fragment,d),h=!0)},o(d){O(n),O(_.$$.fragment,d),h=!1},d(d){d&&p(e),f[o].d(),te(_),u=!1,mt(a)}}}function Qt(l){let e,t,s,o=l[8]+1+"",n,i=`${l[19]}%`,c,_,h,u=l[9].answers&&De(l),a=l[11]&&Me(l);return{c(){e=q("body"),t=q("div"),s=q("div"),n=T(o),c=C(),u&&u.c(),_=C(),a&&a.c(),this.h()},l(r){e=w(r,"BODY",{class:!0});var f=I(e);t=w(f,"DIV",{id:!0});var m=I(t);s=w(m,"DIV",{class:!0});var d=I(s);n=P(d,o),d.forEach(p),c=j(m),u&&u.l(m),_=j(m),a&&a.l(m),m.forEach(p),f.forEach(p),this.h()},h(){k(s,"class","quiz-question-number"),Y(s,"line-height",i),k(t,"id","content"),k(e,"class","quiz")},m(r,f){Q(r,e,f),v(e,t),v(t,s),v(s,n),v(t,c),u&&u.m(t,null),v(t,_),a&&a.m(t,null),h=!0},p(r,f){(!h||f[0]&256)&&o!==(o=r[8]+1+"")&&F(n,o),f[0]&524288&&i!==(i=`${r[19]}%`)&&Y(s,"line-height",i),r[9].answers?u?u.p(r,f):(u=De(r),u.c(),u.m(t,_)):u&&(u.d(1),u=null),r[11]?a?(a.p(r,f),f[0]&2048&&B(a,1)):(a=Me(r),a.c(),B(a,1),a.m(t,null)):a&&(ae(),O(a,1,1,()=>{a=null}),fe())},i(r){h||(B(a),h=!0)},o(r){O(a),h=!1},d(r){r&&p(e),u&&u.d(),a&&a.d()}}}function Ct(l){let e,t,s,o=l[18].Quiz_Score_Page_Message_Before+"",n,i,c,_,h,u,a,r=l[18].Quiz_Score_Page_Message_After.replace("%n%",l[8])+"",f,m,d,g=l[21](l[7])+"",E,z,V,D=!l[4]&&Te(me(l));return{c(){e=q("div"),t=q("div"),s=q("div"),n=T(o),i=C(),c=q("div"),_=q("span"),h=T(l[7]),u=C(),a=q("div"),f=T(r),m=C(),d=q("div"),E=T(g),z=C(),D&&D.c(),V=Z(),this.h()},l(A){e=w(A,"DIV",{class:!0});var S=I(e);t=w(S,"DIV",{id:!0,class:!0});var M=I(t);s=w(M,"DIV",{class:!0});var G=I(s);n=P(G,o),G.forEach(p),i=j(M),c=w(M,"DIV",{class:!0});var U=I(c);_=w(U,"SPAN",{class:!0});var W=I(_);h=P(W,l[7]),W.forEach(p),U.forEach(p),u=j(M),a=w(M,"DIV",{class:!0});var J=I(a);f=P(J,r),J.forEach(p),m=j(M),d=w(M,"DIV",{class:!0});var R=I(d);E=P(R,g),R.forEach(p),M.forEach(p),S.forEach(p),z=j(A),D&&D.l(A),V=Z(),this.h()},h(){k(s,"class","quiz-score-before"),k(_,"class","quiz-score"),k(c,"class","quiz-score-block"),k(a,"class","quiz-score-after"),k(d,"class","quiz-score-commentary"),k(t,"id","content"),k(t,"class","text-center"),k(e,"class","score")},m(A,S){Q(A,e,S),v(e,t),v(t,s),v(s,n),v(t,i),v(t,c),v(c,_),v(_,h),v(t,u),v(t,a),v(a,f),v(t,m),v(t,d),v(d,E),Q(A,z,S),D&&D.m(A,S),Q(A,V,S)},p(A,S){S[0]&262144&&o!==(o=A[18].Quiz_Score_Page_Message_Before+"")&&F(n,o),S[0]&128&&F(h,A[7]),S[0]&262400&&r!==(r=A[18].Quiz_Score_Page_Message_After.replace("%n%",A[8])+"")&&F(f,r),S[0]&128&&g!==(g=A[21](A[7])+"")&&F(E,g),A[4]?D&&(D.d(1),D=null):D?D.p(me(A),S):(D=Te(me(A)),D.c(),D.m(V.parentNode,V))},i:H,o:H,d(A){A&&(p(e),p(z),p(V)),D&&D.d(A)}}}function jt(l){let e,t,s=l[0].quizId+"",o,n,i,c="Before accessing this quiz, you need to pass the following quiz:",_,h,u=(l[0].dependentQuizName||l[0].dependentQuizId)+"",a;return{c(){e=q("div"),t=q("div"),o=T(s),n=C(),i=q("div"),i.textContent=c,_=C(),h=q("div"),a=T(u),this.h()},l(r){e=w(r,"DIV",{class:!0});var f=I(e);t=w(f,"DIV",{class:!0});var m=I(t);o=P(m,s),m.forEach(p),n=j(f),i=w(f,"DIV",{class:!0,"data-svelte-h":!0}),Oe(i)!=="svelte-1afiytz"&&(i.textContent=c),_=j(f),h=w(f,"DIV",{class:!0});var d=I(h);a=P(d,u),d.forEach(p),f.forEach(p),this.h()},h(){k(t,"class","quiz-locked-title"),k(i,"class","quiz-locked-message"),k(h,"class","quiz-locked-name"),k(e,"class","quiz-locked")},m(r,f){Q(r,e,f),v(e,t),v(t,o),v(e,n),v(e,i),v(e,_),v(e,h),v(h,a)},p(r,f){f[0]&1&&s!==(s=r[0].quizId+"")&&F(o,s),f[0]&1&&u!==(u=(r[0].dependentQuizName||r[0].dependentQuizId)+"")&&F(a,u)},i:H,o:H,d(r){r&&p(e)}}}function De(l){let e=l[9].answers.some(Fe),t,s=l[9].answers.some(Be),o,n=e&&Se(l),i=s&&je(l);return{c(){n&&n.c(),t=C(),i&&i.c(),o=Z()},l(c){n&&n.l(c),t=j(c),i&&i.l(c),o=Z()},m(c,_){n&&n.m(c,_),Q(c,t,_),i&&i.m(c,_),Q(c,o,_)},p(c,_){_[0]&512&&(e=c[9].answers.some(Fe)),e?n?n.p(c,_):(n=Se(c),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null),_[0]&512&&(s=c[9].answers.some(Be)),s?i?i.p(c,_):(i=je(c),i.c(),i.m(o.parentNode,o)):i&&(i.d(1),i=null)},d(c){c&&(p(t),p(o)),n&&n.d(c),i&&i.d(c)}}}function Se(l){let e,t,s=l[9].text+"",o,n,i=`${l[19]}%`,c,_,h,u,a,r=l[9].image&&Ve(l),f=ue(l[5]),m=[];for(let g=0;g<f.length;g+=1)m[g]=Qe(Ae(l,f,g));let d=l[12]&&Ce(l);return{c(){e=q("div"),t=q("div"),o=T(s),n=C(),r&&r.c(),c=C(),_=q("div"),h=q("div");for(let g=0;g<m.length;g+=1)m[g].c();a=C(),d&&d.c(),this.h()},l(g){e=w(g,"DIV",{class:!0});var E=I(e);t=w(E,"DIV",{class:!0});var z=I(t);o=P(z,s),n=j(z),r&&r.l(z),z.forEach(p),c=j(E),_=w(E,"DIV",{class:!0});var V=I(_);h=w(V,"DIV",{class:!0});var D=I(h);for(let A=0;A<m.length;A+=1)m[A].l(D);D.forEach(p),V.forEach(p),a=j(E),d&&d.l(E),E.forEach(p),this.h()},h(){k(t,"class","quiz-question"),Y(t,"line-height",i),k(h,"class",u="grid grid-cols-"+(l[9].columns??1)+" justify-items-center svelte-3jb08n"),k(_,"class","quiz-answer-block"),k(e,"class","quiz-question-block svelte-3jb08n")},m(g,E){Q(g,e,E),v(e,t),v(t,o),v(t,n),r&&r.m(t,null),v(e,c),v(e,_),v(_,h);for(let z=0;z<m.length;z+=1)m[z]&&m[z].m(h,null);v(e,a),d&&d.m(e,null)},p(g,E){if(E[0]&512&&s!==(s=g[9].text+"")&&F(o,s),g[9].image?r?r.p(g,E):(r=Ve(g),r.c(),r.m(t,null)):r&&(r.d(1),r=null),E[0]&524288&&i!==(i=`${g[19]}%`)&&Y(t,"line-height",i),E[0]&8391720){f=ue(g[5]);let z;for(z=0;z<f.length;z+=1){const V=Ae(g,f,z);m[z]?m[z].p(V,E):(m[z]=Qe(V),m[z].c(),m[z].m(h,null))}for(;z<m.length;z+=1)m[z].d(1);m.length=f.length}E[0]&512&&u!==(u="grid grid-cols-"+(g[9].columns??1)+" justify-items-center svelte-3jb08n")&&k(h,"class",u),g[12]?d?d.p(g,E):(d=Ce(g),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},d(g){g&&p(e),r&&r.d(),Le(m,g),d&&d.d()}}}function Ve(l){let e,t;return{c(){e=q("img"),this.h()},l(s){e=w(s,"IMG",{class:!0,src:!0}),this.h()},h(){k(e,"class","quiz-question-image h-40 svelte-3jb08n"),ce(e.src,t=l[20](l[9].image))||k(e,"src",t)},m(s,o){Q(s,e,o)},p(s,o){o[0]&512&&!ce(e.src,t=s[20](s[9].image))&&k(e,"src",t)},d(s){s&&p(e)}}}function Qe(l){let e,t,s=l[51].text+"",o,n,i,c;function _(){return l[29](l[51])}return{c(){e=q("button"),t=q("div"),o=T(s),n=C(),this.h()},l(h){e=w(h,"BUTTON",{class:!0});var u=I(e);t=w(u,"DIV",{class:!0});var a=I(t);o=P(a,s),a.forEach(p),n=j(u),u.forEach(p),this.h()},h(){k(t,"class","quiz-answer svelte-3jb08n"),L(t,"textCorrectSelect",l[10]&&l[51].correct&&(l[51].clicked||l[11])),L(t,"textWrongSelect",l[10]&&l[51].clicked&&!l[51].correct),L(t,"textHighlight",l[3]===l[53]),k(e,"class","w-5/6 md:w-64 lg:w-[20rem] mt-2")},m(h,u){Q(h,e,u),v(e,t),v(t,o),v(e,n),i||(c=ne(e,"click",_),i=!0)},p(h,u){l=h,u[0]&32&&s!==(s=l[51].text+"")&&F(o,s),u[0]&3104&&L(t,"textCorrectSelect",l[10]&&l[51].correct&&(l[51].clicked||l[11])),u[0]&1056&&L(t,"textWrongSelect",l[10]&&l[51].clicked&&!l[51].correct),u[0]&8&&L(t,"textHighlight",l[3]===l[53])},d(h){h&&p(e),i=!1,c()}}}function Ce(l){let e,t;return{c(){e=q("div"),t=T(l[12]),this.h()},l(s){e=w(s,"DIV",{class:!0});var o=I(e);t=P(o,l[12]),o.forEach(p),this.h()},h(){k(e,"class","quiz-answer-explanation mt-4")},m(s,o){Q(s,e,o),v(e,t)},p(s,o){o[0]&4096&&F(t,s[12])},d(s){s&&p(e)}}}function je(l){let e,t,s=l[9].text+"",o,n,i,c,_,h,u=ue(l[5]),a=[];for(let f=0;f<u.length;f+=1)a[f]=ye(Ee(l,u,f));let r=l[12]&&Ne(l);return{c(){e=q("div"),t=q("div"),o=T(s),n=C(),i=q("div"),c=q("div");for(let f=0;f<a.length;f+=1)a[f].c();h=C(),r&&r.c(),this.h()},l(f){e=w(f,"DIV",{class:!0});var m=I(e);t=w(m,"DIV",{class:!0});var d=I(t);o=P(d,s),d.forEach(p),n=j(m),i=w(m,"DIV",{class:!0});var g=I(i);c=w(g,"DIV",{class:!0});var E=I(c);for(let z=0;z<a.length;z+=1)a[z].l(E);E.forEach(p),g.forEach(p),h=j(m),r&&r.l(m),m.forEach(p),this.h()},h(){k(t,"class","quiz-question"),k(c,"class",_="grid grid-cols-"+(l[9].columns??2)+" gap-2 svelte-3jb08n"),k(i,"class","flex justify-center"),k(e,"class","quiz-question-block svelte-3jb08n")},m(f,m){Q(f,e,m),v(e,t),v(t,o),v(e,n),v(e,i),v(i,c);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(c,null);v(e,h),r&&r.m(e,null)},p(f,m){if(m[0]&512&&s!==(s=f[9].text+"")&&F(o,s),m[0]&9440296){u=ue(f[5]);let d;for(d=0;d<u.length;d+=1){const g=Ee(f,u,d);a[d]?a[d].p(g,m):(a[d]=ye(g),a[d].c(),a[d].m(c,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=u.length}m[0]&512&&_!==(_="grid grid-cols-"+(f[9].columns??2)+" gap-2 svelte-3jb08n")&&k(c,"class",_),f[12]?r?r.p(f,m):(r=Ne(f),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(f){f&&p(e),Le(a,f),r&&r.d()}}}function ye(l){let e,t,s,o,n,i,c;function _(){return l[30](l[51])}return{c(){e=q("div"),t=q("img"),n=C(),this.h()},l(h){e=w(h,"DIV",{class:!0});var u=I(e);t=w(u,"IMG",{class:!0,src:!0,alt:!0}),n=j(u),u.forEach(p),this.h()},h(){k(t,"class","cursor-pointer svelte-3jb08n"),ce(t.src,s=l[20](l[51].image))||k(t,"src",s),k(t,"alt",o=l[51].text),k(e,"class","w-full flex justify-center p-[4%] svelte-3jb08n"),L(e,"imageCorrectSelect",l[10]&&l[51].correct&&(l[51].clicked||l[11])),L(e,"imageWrongSelect",l[10]&&l[51].clicked&&!l[51].correct),L(e,"textHighlight",l[3]===l[53])},m(h,u){Q(h,e,u),v(e,t),v(e,n),i||(c=ne(t,"click",_),i=!0)},p(h,u){l=h,u[0]&32&&!ce(t.src,s=l[20](l[51].image))&&k(t,"src",s),u[0]&32&&o!==(o=l[51].text)&&k(t,"alt",o),u[0]&3104&&L(e,"imageCorrectSelect",l[10]&&l[51].correct&&(l[51].clicked||l[11])),u[0]&1056&&L(e,"imageWrongSelect",l[10]&&l[51].clicked&&!l[51].correct),u[0]&8&&L(e,"textHighlight",l[3]===l[53])},d(h){h&&p(e),i=!1,c()}}}function Ne(l){let e,t;return{c(){e=q("div"),t=T(l[12]),this.h()},l(s){e=w(s,"DIV",{class:!0});var o=I(e);t=P(o,l[12]),o.forEach(p),this.h()},h(){k(e,"class","quiz-answer-explanation mt-4")},m(s,o){Q(s,e,o),v(e,t)},p(s,o){o[0]&4096&&F(t,s[12])},d(s){s&&p(e)}}}function Me(l){let e,t,s,o,n,i;return s=new kt({}),{c(){e=q("div"),t=q("button"),$(s.$$.fragment),this.h()},l(c){e=w(c,"DIV",{class:!0,style:!0});var _=I(e);t=w(_,"BUTTON",{class:!0});var h=I(t);x(s.$$.fragment,h),h.forEach(p),_.forEach(p),this.h()},h(){k(t,"class","dy-btn dy-btn-active p-2 px-8 mt-4"),k(e,"class","quiz-next-button arrow-ltr flex justify-center items-center"),Y(e,"cursor","pointer")},m(c,_){Q(c,e,_),v(e,t),ee(s,t,null),o=!0,n||(i=ne(t,"click",l[31]),n=!0)},p:H,i(c){o||(B(s.$$.fragment,c),o=!0)},o(c){O(s.$$.fragment,c),o=!1},d(c){c&&p(e),te(s),n=!1,i()}}}function Te(l){let e,t,s={ctx:l,current:null,token:null,hasCatch:!0,pending:Mt,then:Nt,catch:yt,value:49,error:50};return we(t=Ie({collection:l[2].collection,book:l[1],score:l[7],passScore:l[14],pass:l[48]}),s),{c(){e=Z(),s.block.c()},l(o){e=Z(),s.block.l(o)},m(o,n){Q(o,e,n),s.block.m(o,s.anchor=n),s.mount=()=>e.parentNode,s.anchor=e},p(o,n){l=o,s.ctx=l,n[0]&16518&&t!==(t=Ie({collection:l[2].collection,book:l[1],score:l[7],passScore:l[14],pass:l[48]}))&&we(t,s)||wt(s,l,n)},d(o){o&&p(e),s.block.d(o),s.token=null,s=null}}}function yt(l){let e,t,s=l[50].message+"",o;return{c(){e=q("p"),t=T("Error saving quiz result: "),o=T(s)},l(n){e=w(n,"P",{});var i=I(e);t=P(i,"Error saving quiz result: "),o=P(i,s),i.forEach(p)},m(n,i){Q(n,e,i),v(e,t),v(e,o)},p(n,i){i[0]&16518&&s!==(s=n[50].message+"")&&F(o,s)},d(n){n&&p(e)}}}function Nt(l){let e,t="Quiz result saved!";return{c(){e=q("p"),e.textContent=t},l(s){e=w(s,"P",{"data-svelte-h":!0}),Oe(e)!=="svelte-t6ljco"&&(e.textContent=t)},m(s,o){Q(s,e,o)},p:H,d(s){s&&p(e)}}}function Mt(l){return{c:H,l:H,m:H,p:H,d:H}}function Tt(l){let e,t,s,o,n,i,c=`${l[17]}px`,_;s=new vt({props:{$$slots:{"right-buttons":[Vt],"left-buttons":[At]},$$scope:{ctx:l}}});const h=[jt,Ct,Qt],u=[];function a(r,f){return r[15]?0:r[8]==r[6].length?1:2}return n=a(l),i=u[n]=h[n](l),{c(){e=q("div"),t=q("div"),$(s.$$.fragment),o=C(),i.c(),this.h()},l(r){e=w(r,"DIV",{class:!0});var f=I(e);t=w(f,"DIV",{class:!0});var m=I(t);x(s.$$.fragment,m),m.forEach(p),o=j(f),i.l(f),f.forEach(p),this.h()},h(){k(t,"class","navbar"),k(e,"class","grid grid-rows-[auto,1fr] h-screen"),Y(e,"font-size",c)},m(r,f){Q(r,e,f),v(e,t),ee(s,t,null),v(e,o),u[n].m(e,null),_=!0},p(r,f){const m={};f[0]&73728|f[1]&16777216&&(m.$$scope={dirty:f,ctx:r}),s.$set(m);let d=n;n=a(r),n===d?u[n].p(r,f):(ae(),O(u[d],1,1,()=>{u[d]=null}),fe(),i=u[n],i?i.p(r,f):(i=u[n]=h[n](r),i.c()),B(i,1),i.m(e,null)),f[0]&131072&&c!==(c=`${r[17]}px`)&&Y(e,"font-size",c)},i(r){_||(B(s.$$.fragment,r),B(i),_=!0)},o(r){O(s.$$.fragment,r),O(i),_=!1},d(r){r&&p(e),te(s),u[n].d()}}}function Pe(l){const e=Math.floor(Math.random()*l.length);return l[e]}function Pt(l){let e=l.length,t;for(;e!=0;)t=Math.floor(Math.random()*e),e--,[l[e],l[t]]=[l[t],l[e]];return l}function Bt(l){let e=l.length,t;for(;e!==0;)t=Math.floor(Math.random()*e),e--,[l[e],l[t]]=[l[t],l[e]];return l}const Be=l=>l.image,Fe=l=>l.text;function Ft(l,e,t){let s,o,n,i,c,_,h,u,a,r,f,m;oe(l,qe,b=>t(16,u=b)),oe(l,ot,b=>t(2,a=b)),oe(l,nt,b=>t(17,r=b)),oe(l,it,b=>t(18,f=b)),oe(l,rt,b=>t(19,m=b));let{data:d}=e,g=-1,E=!1,z=[],V=[],D=0,A=0,S,M=!1,G=!1,U=null,W=null,J=null,R="";const pe=st(re.programVersion,"12.0")<0?"assets":"quiz";function le(b,y,N="answer"){let K=new Audio;N==="question"&&(U=K),N==="answer"&&(W=K),N==="explanation"&&(J=K),K.src=b,K.onended=function(){y&&y()},K.play()}tt(()=>{se(),ke()});function Ue(){U&&(U.pause(),U.currentTime=0,U=null)}function We(){W&&(W.pause(),W.currentTime=0,W=null)}function Je(){J&&(J.pause(),J.currentTime=0,J=null)}function se(){Ue(),We(),Je()}function Re(b){return`${X}/illustrations/${a.collection}-${o.id}-${b}`}function be(){if(t(12,R=""),A==V.length)t(5,z=[]),ge(D);else{t(9,S=V[A]);for(const b of S.answers)b.clicked=!1;t(5,z=Pt(S.answers))}}function ge(b){let y="";for(const N of o.commentary)if(b>=N.rangeMin&&b<=N.rangeMax){y=N.message;break}return y}function ve(){se(),t(8,A++,A),t(10,M=!1),t(11,G=!1),be(),ze()}function ke(){t(10,M=!1),t(11,G=!1),t(5,z=[]),t(12,R="")}function Xe(b,y){let N;return y?N=b.rightAnswerAudio?"clips/"+Pe(b.rightAnswerAudio):pe+"/quiz-right-answer.mp3":N=b.wrongAnswerAudio?"clips/"+Pe(b.wrongAnswerAudio):pe+"/quiz-wrong-answer.mp3",N}function de(b){if(t(3,g=-1),se(),!M){const y=Xe(o,b.correct),N=`${X}/${y}`;le(N,()=>{!b.correct&&b.explanation&&b.explanation.text?(t(12,R=b.explanation.text),b.explanation.audio&&le(`${X}/clips/${b.explanation.audio}`,null,"explanation")):!b.correct&&S.explanation&&S.explanation.text&&(t(12,R=S.explanation.text),S.explanation.audio&&le(`${X}/clips/${S.explanation.audio}`,null,"explanation"))}),b.correct&&t(7,D++,D),setTimeout(()=>{b.clicked=!0,t(10,M=!0),b.correct?t(11,G=!0):setTimeout(()=>{t(11,G=!0)},1e3)},0)}}function ze(){if(u){const b=Ye();if(b)if(b.audio){const y=()=>{_e(0)};le(`${X}/clips/${b.audio}`,y,"question")}else _e(0)}}function _e(b){if(S&&u)if(b<S.answers.length){const y=S.answers[b];if(y.audio){const N=()=>{t(3,g=-1),_e(b+1)};t(3,g=b),le(`${X}/clips/${y.audio}`,N,"answer")}}else t(3,g=-1)}function Ye(){return V[A]}ht(()=>{se()});const Ke=()=>{pt(qe,u=!u,u)},Ze=()=>ct.open(ut),$e=b=>{de(b)},xe=b=>{de(b)},et=()=>{ve()};return l.$$set=b=>{"data"in b&&t(0,d=b.data)},l.$$.update=()=>{l.$$.dirty[0]&1&&t(15,{locked:s,quiz:o,quizId:n,quizName:i,passScore:c}=d,s,(t(24,o),t(0,d)),(t(1,n),t(0,d)),(t(26,i),t(0,d)),(t(14,c),t(0,d))),l.$$.dirty[0]&6&&t(25,_=re.bookCollections.find(b=>b.id===a.collection).books.find(b=>b.id===n)),l.$$.dirty[0]&67108864&&t(13,h=i||"Quiz"),l.$$.dirty[0]&50331648&&(o?(ke(),t(7,D=0),t(8,A=0),t(5,z=[]),t(6,V=_.quizFeatures["shuffle-questions"]?Bt([...o.questions]):[...o.questions]),be(),ze(),t(4,E=!1)):(se(),t(7,D=0),t(8,A=0),t(5,z=[]),t(6,V=[]),t(4,E=!1)))},[d,n,a,g,E,z,V,D,A,S,M,G,R,h,c,s,u,r,f,m,Re,ge,ve,de,o,_,i,Ke,Ze,$e,xe,et]}class Kt extends bt{constructor(e){super(),gt(this,e,Ft,Tt,_t,{data:0},null,[-1,-1])}}export{Kt as component,Yt as universal};
