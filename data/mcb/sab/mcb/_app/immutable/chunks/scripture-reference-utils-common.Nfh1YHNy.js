import{p as ae}from"./scheduler.B2eiZa_g.js";import{I as b,h as Q,J as ie,r as ce,K as y,L as X,N as I,O as $,P as J,Q as Y,R as H,T as ee,U as W,V as le}from"./theme.CEnq8wkH.js";import{s as pe,f as G}from"./numeralSystem.bc9fPTup.js";function q(e){let t=0;try{t=parseInt(e,10)}catch{const o=te(e);if(b(o))try{t=parseInt(o,10)}catch{}}return t}function te(e){const t=[];for(let n=0;n<e.length;n++){const o=e.charAt(n),s=parseInt(o,10);isNaN(s)?t.push(o):t.push(s.toString())}return t.join("")}let D,ne,L,B,oe,se,U,re,j,P,g;function fe(e,t,n=void 0){const o=document.createElement("a");return o.classList.add("cursor-pointer"),b(e)&&o.classList.add(e),o.href="javascript:void(0)",o.innerHTML=t.phrase,o.setAttribute("data-start-ref",JSON.stringify(t)),o.setAttribute("data-end-ref",JSON.stringify(n)),o}function ue(){L=ne.find(e=>e.id===D.collection),B=L.features,U=B["ref-chapter-verse-separator"],re=B["ref-verse-range-separator"],j=B["ref-verse-list-separator"],P=B["ref-chapter-range-separator"],B["ref-chapter-list-separator"],oe=B["show-scripture-refs"],g=B["ref-extra-material"],b(g)&&(Re(),Ne())}function Ae(e,t,n=""){return D=ae(ce),ne=Q.bookCollections,se=D.catalog,he(e,t,n)}function he(e,t,n=""){ue();const o=y(n)?D.book:n,s=D.docSet,a="\\xt "+e+"\\xt*",c="\\\\(\\+?)xt[ \\xA0]([\\s\\S\\xA0]*?)(?:\\|([\\s\\S]*?))?\\\\\\1xt\\*",i=new RegExp(c,"g");let l,h="",r=0;for(;(l=i.exec(a))!==null;){const p=l[2],d=l[3],v=b(d)?d:p,V=b(d)?p:null;let S=U,f=re;b(d)&&(S=":",f="-");const u=ge(v,s,o,V,S,f,t);h+=a.substring(r,l.index),h+=u,r+=l.index+l[0].length}return h+=a.substring(r),h}function Fe(e,t=null){var a;const o=((a=(t??Q).bookCollections.find(c=>c.id===e.collection).books.find(c=>c.id===e.book))==null?void 0:a.testament)||"";return o==="NT"||o==="OT"||o==="DC"}function ge(e,t,n,o,s,a,c){let i="";if(oe){const l=me(s,a);i=de(l,e,t,n,o,s,a,c)}else i=e;return i}function de(e,t,n,o,s,a,c,i){let l=o;const h=new RegExp(e,"g");let r,p="",d="",v=0;for(;(r=h.exec(t))!==null;){const V=X(r[0]);let S=r[2],f=null;if(!V)if(b(S)){if(f=xe(S),l=null,!I(f)&&b(s)){const u=Se(S);b(u)&&(f=u)}}else f=l,S="";if(I(f)){let u="";const E=y(S)?"":S+" ",m=$(r[1]),R=$(r[13]);if(I(r[3])){const k=r[4],M=r[5],w=r[6],N=r[7],x=r[8];J(k),J(N);const A=m+E+k+U+M+w+N+U+x+R,T=O("",n,f,k,N,M,x);u=F(T,s,A,i)}else if(I(r[9])){let k=r[10],M=q(k),w=$(r[11]);w==="‑"&&c==="-"&&(w="-");let N=r[12];const x=z(f);if(x===1&&(M=1,I(N)?w===c&&(N=k+w+N):N=k,k=""),I(N))if(w===P&&x>1){const A=k+P+N;u=Ce(t,s,n,f,E,m,R,A,i)}else w===a||x===1?u=Le(t,s,n,f,E,m,R,k,M,N,a,c,i):u=r[9];else{const A=Z(f,k),T=m+E+k+R,_=O("",n,f,k,"","1",A);u=F(_,s,T,i)}}p=u,l=f}else if(V&&b(l)){f=l;const u=Y(r[0]),E=z(f);let m="";if(u<=E){const R=u.toString(),k=u.toString(),M=Z(f,k),w=O("",n,f,k,"","1",M);m=F(w,s,R,i)}else m=b(s)?s:r[0];p=m}else p=b(s)?s:r[0];d+=t.substring(v,r.index),d+=p,v=r.index+r[0].length}return d+=t.substring(v),d}function me(e,t){const n=b(g)?"("+g+")?":"()",o=e==="."?"\\.":e,s=j==="."?"\\.":j,a="[\\u200f]?",c="(\\d{1,3})",i="\\d{1,3}",l="(\\d{1,3})",h=be();let r=P;r==="-"&&(r=r+"|\\u2011");const p=c+o+l+"("+r+")"+c+o+l;let d=P;if(P!==t){const k=t==="-"?"\\-":t;d=d+"|"+k}(P==="-"||t==="-")&&(d=d+"|\\u2011");const v="(?!(\\d*"+o+"\\d)|(\\d?\\p{Lu})|(\\d?\\s\\p{Lu}))",V=i+v+"(?:"+a+"(?:"+d+")"+i+")?",S="("+V+"(?:"+s+"\\s?"+V+")*)",f="(["+d+o+"])",u=c+"(?:"+a+f+S+")?",E="("+p+")|("+u+")";let m=n+"(?:("+h+")\\s)?(?:"+E+")"+n;return m=m+"(?![^<]*>|[^<>]*</)",m}function be(){let e=Ve();return e=e.replace(/-/g,"\\-"),"(?:[123] )?[\\w\\p{L}][\\w\\p{L}\\p{M}\\s"+e+"]*"}function ke(){const e="\\d{1,3}",t="[\\u200f]?";let n=P;return P==="-"&&(n=n+"\\u2011"),"("+e+")(?:"+t+"["+n+"]("+e+"))?"}function ve(e){const t="\\d{1,3}",n="[\\u200f]?";let o=e;return o==="-"&&(o=o+"\\u2011"),"("+t+")(?:"+n+"["+o+"]("+t+"))?"}function xe(e){let t,n=0;for(;n<L.books.length;){if(H(L.books[n].name,e)||H(L.books[n].abbreviation,e)||H(L.books[n].abbreviation+".",e)){t=L.books[n].id;break}if(I(L.books[n].additionalNames)){let o=0;for(;o<L.books[n].additionalNames.length;){if(H(L.books[n].additionalNames[o].name,e)){t=L.books[n].id;break}o++}if(I(t))break}n++}return t}function Se(e){let t="",n=0;for(;n<L.books.length;){if(H(L.books[n].id,e)){t=L.books[n].id;break}n++}return t}function z(e){var n;return((n=L.books.find(o=>o.id===e))==null?void 0:n.chapters)||0}function Ce(e,t,n,o,s,a,c,i,l){const h=ke();let r=!0,p=0,d=0,v="";const V=new RegExp(h,"g");let S;const f=[];for(;(S=V.exec(i))!==null;)p++,f.push(S);V.lastIndex=0;for(let u=0;u<p;u++){const E=f[u],m=E[1],R=E[2],k=e.includes("‏");let M=m;I(R)&&(k?M=m+"‏"+P+R:M=M+P+R);const w=Z(o,m),N=O("",n,o,m,m,"1",w);let x;r?(x=s+M,x=a+x,d==p-1&&(x=x+c),v=F(N,t,x,l),r=!1):(x=M,d==p-1&&(x=x+c),v=v+j+F(N,t,x,l)),d++}return v}function Le(e,t,n,o,s,a,c,i,l,h,r,p,d){let v="",V=0,S=0,f=!0;const u=e.includes("‏"),E=ve(p),m=new RegExp(E,"g");let R;const k=[];for(;(R=m.exec(h))!==null;)V++,k.push(R);m.lastIndex=0;for(let M=0;M<V;M++){const w=k[M],N=w[1],x=w[2],A=u;let T=N;I(x)&&(A?T=N+"‏"+p+x:T=T+p+x);const _=O("",n,o,l.toString(),"",N,x);let C="";f?(C=s+i,C=C.trim(),b(T)&&(u&&(C=C+"‏"),y(i)?(C=C+" "+T,C=C.trim()):C=C+r+T),C=a+C,S==V-1&&(C=C+c),v=F(_,t,C,d),f=!1):(C=T,S==V-1&&(C=C+c),v=v+j+F(_,t,C,d)),S++}return v}function F(e,t,n,o){let s="",a=n;b(t)&&(a=t),e.text=a;const c={phrase:e.text,docSet:e.collection,book:e.bookId,chapter:e.fromChapter,verse:e.fromVerse},l=y(e.toChapter)&&y(e.toVerse)?void 0:{phrase:e.text,docSet:e.collection,book:e.bookId,chapter:b(e.toChapter)?e.toChapter:e.fromChapter,verse:b(e.toVerse)?e.toVerse:e.fromVerse};return s=fe(o,c,l).outerHTML,s}function Z(e,t,n){if(!t||t==="i")return"0";const s=se.documents.find(i=>i.bookCode===e).versesByChapters,a=Object.keys(s[t]);return a[a.length-1]}function O(e,t,n,o,s,a,c){const i={};return i.text=e,i.collection=t,i.bookId=n,i.fromChapter=o,i.toChapter=s,i.fromVerse=a,i.toVerse=c,i}function Re(){const e=g.split("|"),t=function(o,s){return s.length-o.length};e.sort(t);let n="";e.forEach(function(o,s){s>0&&(n+="|"),n+=o}),g=n}function Ne(){g=g.replace("\\","\\\\"),g=g.replace("+","\\+"),g=g.replace(".","\\."),g=g.replace("?","\\?"),g=g.replace("*","\\*"),g=g.replace("^","\\^"),g=g.replace("$","\\$"),g=g.replace("(","\\("),g=g.replace(")","\\)"),g=g.replace("[","\\["),g=g.replace("]","\\]")}function Ve(){const e=new Set;let t=0;for(;t<L.books.length;){const n=L.books[t].name,o=L.books[t].abbreviation,s=L.books[t].additionalNames;let a=I(n)?n.replace(/[\p{L}\p{M}]/gu,""):"";if(K(a,e),a=I(o)?o.replace(/[\p{L}\p{M}]/gu,""):"",K(a,e),I(s)){let c=0;for(;c<s.length;){const i=s[c].name;a=I(i)?i.replace(/[\p{L}\p{M}]/gu,""):"",K(a,e),c++}}t++}return Array.from(e).join("")}function K(e,t){for(let n=0;n<e.length;n++)t.add(e.charAt(n))}async function He(e,t,n){console.log("HandleHeaderLinkPressed start: %o end: %o colors: %o",e,t,n);const o=n.PrimaryColor,s=document.createElement("div"),a=document.createElement("div"),c=document.createElement("div"),i=document.createElement("button");c.id="icon";const l=document.createElement("span"),h=document.createElement("span");s.classList.add("flex","flex-row","justify-space-between"),l.classList.add("fr"),h.classList.add("ft"),i.setAttribute("reference",JSON.stringify(e)),i.classList.add("p-2");const r=`<svg fill='${o}' xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h560v-280h80v280q0 33-23.5 56.5T760-120H200Zm188-212-56-56 372-372H560v-80h280v280h-80v-144L388-332Z"/></svg>`;return i.innerHTML=r,l.innerText=`${e.phrase} `,h.innerText=await ie(e,t),a.appendChild(l),a.appendChild(h),c.appendChild(i),s.appendChild(a),s.appendChild(c),s.outerHTML}function Oe(e,t,n,o){return Me(Q,e,t,n,o)}function Me(e,t,n,o,s){var r;let a="";const c=e.bookCollections.find(p=>p.id===t).features["ref-chapter-verse-separator"],i=e.bookCollections.find(p=>p.id===t).features["ref-verse-range-separator"],l="‏",h=e.bookCollections.find(p=>p.id===t);if(h){const d=h.style.textDirection.toLowerCase()==="rtl",v=pe(e,t,n),V=G(v,o.toString()),S=((r=h.books.find(m=>m.id===n))==null?void 0:r.name)||n;d&&(a=" "),a=a+S+" "+V;const[f,u,E]=s[0];if(f>-1){const m=G(v,f.toString());if(d){if(a=a+l+c+m,u>-1){const R=G(v,u.toString());a=a+l+i+R}}else if(a=a+c+m,u>-1){const R=G(v,u.toString());a=a+i+R}}}return a}function ye(e){let t,n,o,s,a;if(n="",o=-1,s=-1,a=[[-1,-1,""]],t="",b(e)){let c;if(e.includes("|")){const r=e.indexOf("|");t=e.substring(0,r),c=e.length>r+1?e.substring(r+1):""}else if(e.includes("/")){const r=e.indexOf("/");t=e.substring(0,r),c=e.length>r+1?e.substring(r+1):""}else{t="",c=e;const r=ee(e,".");if(r.length>2&&W(r[0])&&W(r[1])){const p=e.indexOf(".");t=e.substring(0,p),c=e.substring(p+1)}}let i=c.replace("%20",".");i=i.replace(":","."),i=i.replace(" ","."),i=i.replace("–","-"),i=i.replace("‑","-");const l=/(\w+)(?:.([0-9-]+))?(?:.([0-9-]+))?/,h=i.match(l);if(h){n=h[1];let r=h[2],p=h[3];W(h[1])||(n="",r=h[1],p=h[2]),X(r)?(o=Y(r),s=o):[o,s]=we(r),b(p)&&(a=Ee(p))}}return[t.toUpperCase(),n.toUpperCase(),o,s,a]}function we(e){let t,n;if(b(e)){let o=e.replace("–","-");o=le(o);const s=o.indexOf("-");s>0?(t=q(o.substring(0,s)),n=q(o.substring(s+1))):(t=q(o),n=t)}else t=-1,n=-1;return[t,n]}function Ee(e){const t=[];if(b(e)){const n=ee(e,",");for(const o of n){const s=Ie(o);t.push(s)}}return t}function Ie(e){let t=-1,n=-1,o="",s=b(e)?e.trim():"";if(b(e)){s=e.replace("–","-"),s=te(s);const a=/(\d+(\w?))(?:\u200F?([-,])(\d+(\w?)))?/,c=s.match(a);c&&(t=b(c[1])?J(c[1]):-1,o=b(c[3])?c[3]:"",n=b(c[4])?J(c[4]):-1)}return[t,n,o]}export{Oe as a,Ae as b,ye as g,He as h,Fe as i};
